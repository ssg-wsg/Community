### Event : Grants

Only SSG is authorized to update Grants data, either to provide the estimated grants amount or the disbursed amount. The requests are submitted to the respective DL member. This leads to events being registered across the SSG Training Ecosystem DLT, thereby notifying the respective TPs of the results of grants processing.

***Partners cannot submit Grants disbursement data via the DL Network. The data for this event is for reading only.***

The data submitted for Grants typically should include all the following attributes:

| Payload Attributes                      | Event Fields                  | Mandatory | Input/Output | Data Type | Description                                                                                                                                                                                                                                                                                                |
|-----------------------------------------|-------------------------------|-----------|--------------|-----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| (grants) referenceNumber                | Grants Reference Number       | Y         | Input        | String    | Grants Reference Number <br> Generated by SSG after successful validation                                                                                                                                                                                                                                  |
| (grants) (enrolment) referenceNumber    | Enrolment Reference Number    | Y         | Input        | String    | Enrolment Reference Number <br> Generated by SSG after successful validation                                                                                                                                                                                                                               |
| (grants) (grantAmount) paid             | Paid Grant Amount             | Y         | Input        | String    | Paid grant amount                                                                                                                                                                                                                                                                                          |
| (grants) (grantAmount) estimated        | Estimated Grant Amount        | Y         | Input        | String    | A calculated amount of the grant based on the Rules Engine                                                                                                                                                                                                                                                 |
| (grants) (grantAmount) currencyType     | Currency Type                 | Y         | Input        | String    | Amount Currency Type (SGD)                                                                                                                                                                                                                                                                                 |
| (grants) (sponsoringAgency) uen         | Sponsoring Agency UEN         | Y         | Input        | String    | Sponsoring agency UEN                                                                                                                                                                                                                                                                                      |
| (grants) (sponsoringAgency) name        | Sponsoring Agency Name        | Y         | Input        | String    | Sponsoring Agency Name                                                                                                                                                                                                                                                                                     |
| (grants) (fundingComponent) code        | Funding Component Code        | Y         | Input        | String    | Funding Component Code <br> E.g. CF                                                                                                                                                                                                                                                                        |
| (grants) (fundingComponent) description | Funding Component Description | Y         | Input        | String    | Funding Component Description <br> E.g. Course fee Grants (CF)                                                                                                                                                                                                                                             |
| (grants) (fundingScheme) code           | Funding Scheme Code           | Y         | Input        | String    | Grant scheme Code <br> E.g. ETSS / WSS / BASELINE / WTS / MCES / ETSP                                                                                                                                                                                                                                     |
| (grants) (fundingScheme) description    | Funding Scheme Description    | Y         | Input        | String    | Grant scheme Description <br> For E.g. : <br> 1. Enhanced Training Support for SMEs (ETSS) <br> 2. Workfare Skills Support (WSS) <br> 3. Baseline SkillsFuture Funding (BASELINE) <br> 4. Workfare Training Support Scheme (WTS) <br> 5. Mid-Career Enhanced Subsidy (MCES) <br> 6. Enhanced Training Support Package (ETSP) |
| (grants) grantStatus                    | Grant Status                  | Y         | Input        | String    | Status of the grant <br> E.g. Paid / Cancelled / Pending Payment / Grant Processing                                                                                                                                                                                                                        |
**Input Request Parameters** :
	The input to the DLT comprises of the following parts:

1. **Header** : consists of attributes which are required by the DLT to process the payload

   | Attributes      | Data Type | Description                                                  |
   | --------------- | --------- | ------------------------------------------------------------ |
   | eventType       | String    | Type of the event <br>(Grants) |
   | primaryKey      | String    | Primary Lookup Key<br>CONCAT(Course Reference Number,Trainee ID)|
   | secondaryKey    | String    | Secondary Lookup Key <br>(Course Run Reference Number)       |
   | tertiaryKey     | String    | Tertiary Lookup Key<br>(For Grants Request : Grants Reference Number)             |
   | trainingPartnerUen | String    | Training Partner's UEN |
   | trainingPartnerCode| String    | Training Partner's Branch Code|
   | schemaLocation  | String    | Location of the JSON schema file stored locally in the system|
   | schemaVersion   | String    | Version of the schema                                        |

> The schemaLocation field should point to the location of the file in SSG's Repository.
> For data validation before writing to the DLT, this JSON schema file could be retrieved from SSG's Repository and stored in the local file system. 

2. **Payload**: consists of the actual grants data; all data within the payload is to be encrypted before writing to the DLT

   | Attributes | Data Type              | Description                                           |
   | ---------- | ---------------------- | ----------------------------------------------------- |
   | payload    | Serialized JSON Object | This is the set of nested JSON objects of Grants data |

3. **Public Payload**: additional fields which are **not encrypted** before writing to the DLT

   | Attributes                       | Data Type       | Description                                                  |
   | -------------------------------- | --------------- | ------------------------------------------------------------ |
   | tags                             | Array of String | This is an Array of String tags for future use.              |
   | (source) dateTime | String    | Source System time stamp in seconds <br/>ISO 8601 Datetime format |
   | (source) timeStampInMilliSeconds| String    | Source System time stamp in milli seconds <br/>Unix Datetime format  |
   | (ack) dateTime | String    | Acknowledgement time stamp in seconds. To be provided as "-1" by Source System <br/>ISO 8601 Datetime format |
   | (ack) timeStampInMilliSeconds| String    | Acknowledgement time stamp in milli seconds. To be provided as "-1" by Source System <br/>Unix Datetime format  |

> In order to align with SSG's time, the source system should be in sync with the Amazon Time Sync Service via Network Time Protocol (NTP).
> If the source system time is not aligned with SSG's time, this could lead to improper sequencing of data updates, which in turn would lead to 
erroneous data submission via the DLT.


   4. **DLT Data**: fields updated by the Distributed Ledger. Any values supplied by the source system will not be used.

      | Attributes       | Data Type | Description                               |
      | ---------------- | --------- | ----------------------------------------- |
      | eventSource      | String    | Source system initiating the request      |
      | timeStamp        | String    | Time stamp updated by the DL              |
      | validationResult | String    | Result of the validation performed by SSG |

***The values for the fields in the DLT schema should not be blank; if any field is left blank it will lead to errors in data submission to SSG***

***For manual addition of Grants, TGS should trigger DLT update when grants is paid from CFG only***

This is a sample of the serialized JSON object of Grants data submitted by SSG: 

   ```
"{
 "header": {
     "eventType": "Grants",
     "primaryKey": "TGS-0026008-ESS0118316H",
     "secondaryKey": "10026",
     "tertiaryKey": "GRN-2006-000462",
     "trainingPartnerUen": "T08GB0032G",
     "trainingPartnerCode": "T08GB0032G-01",
     "schemaLocation": "<TBC>",
     "schemaVersion": "TGS_v1.0"
 },
 "payload": {
     "grants": {
         "enrolment": {
             "referenceNumber": "ENR-1912-000123"
         },
         "grantAmount": {
             "estimated": "100.5",
             "paid": "80.5",
             "currencyType": "SGD"
         },
         "sponsoringAgency": {
             "uen": "116GB0003C",
             "name": " SkillsFuture Singapore"
         },
         "fundingScheme": {
             "code": "MCES",
             "description": "Mid-Career Enhanced Subsidy"
         },
         "fundingComponent": {
             "code": "CF",
             "description": "Course Fees"
         },
         "grantStatus": "Grant Processing",
         "referenceNumber": "GRN-2006-000462"
     }
 },
 "publicPayload": {
     "tags": ["TBC"],
     "source": {
         "dateTime": "2020-05-04 20:58:17",
         "timeStampInMilliSeconds": "1588597097880"
     },
     "ack": {
         "dateTime": "-1",
         "timeStampInMilliSeconds": "-1"
     }
 },
 "dltData": {
     "eventSource": "",
     "timeStamp": "",
     "validationResult": ""
 }
}"
   ```

**Submission of data via the DLT** 

SSG generates Grants events on the SSG Training Ecosystem DL Network, in response to the rest of training data submitted via the DL Network. The typical scenarios when Grants events are generated are listed below:

**Successful Enrolment:** Upon successful submission of valid enrolment data, SSG generates the estimated grant amount for that submission. The estimated amount is indicated as shown below:

```
"grantAmount": {
  "estimated": "100.5",
  "paid": "",
  "currencyType": "SGD"
}
```

Other relevant details such as Funding component, schemes etc are also provided. The grant status indicates the current status of the processing and the reference number is to be used by partners for identifying the grant record.

**Grants Payment/Cancellation:** SSG updates the Grants record identified by the relevant Grants reference number upon a change in status such as Cancellation or completion of payment.

```
"grantAmount": {
  "estimated": "100.5",
  "paid": "80.5",
  "currencyType": "SGD"
}
```

Partners listening for Grants events from the DL Network can read this response and process Grants information on their side.



